(()=>{var m=window.location.hostname==="localhost"?"http://localhost:3000":"https://librairie-simple-production-6ca3.up.railway.app",h=m;var n=class{constructor(e,t){this.currentPage=1,this.totalPages=1,this.fetchFunction=e,this.renderFunction=t,this.leftBtn=document.getElementById("gauche"),this.rightBtn=document.getElementById("droite"),this.init()}init(){this.leftBtn.addEventListener("click",()=>this.goToPreviousPage()),this.rightBtn.addEventListener("click",()=>this.goToNextPage()),this.loadPage(this.currentPage)}async loadPage(e){try{let t=await this.fetchFunction(e),a,s;Array.isArray(t)?(console.warn("\u26A0\uFE0F API retourne l'ancien format (array). Mise \xE0 jour backend recommand\xE9e."),a=t,s={page:this.currentPage,totalPages:1,total:t.length,limit:t.length}):(a=t.data,s=t.pagination),this.currentPage=s.page,this.totalPages=s.totalPages,this.renderFunction(a),this.updateButtons()}catch(t){console.error("Erreur lors du chargement de la page :",t)}}goToPreviousPage(){this.currentPage>1&&this.loadPage(this.currentPage-1)}goToNextPage(){this.currentPage<this.totalPages&&this.loadPage(this.currentPage+1)}updateButtons(){this.leftBtn.disabled=this.currentPage===1,this.rightBtn.disabled=this.currentPage===this.totalPages}resetToFirstPage(){this.currentPage=1,this.loadPage(1),this.loadPage(1)}},u=n;var o=document.getElementById("authors-field"),g=document.querySelector("input[type='search']"),p=document.querySelector(".search-bar button"),i=document.querySelector(".reset-search");p.addEventListener("click",()=>y());async function y(){try{i&&(i.style.display="flex");let r=g.value.trim();g.value="";let e=await l(1,r);d(e.data)}catch(r){console.error("Erreur lors de la recherche :",r),alert("Erreur lors de la recherche des auteurs")}}i.addEventListener("click",async()=>{try{i.style.display="none";let r=await l(1);d(r.data),f.resetToFirstPage()}catch(r){console.error("Erreur lors de la r\xE9initialisation de la recherche :",r),alert("Erreur lors de la r\xE9initialisation de la recherche des auteurs")}});async function l(r=1,e=""){try{let t=new URLSearchParams({page:r,limit:6,...e&&{searched:e}}),a=await fetch(`${h}/api/authors?${t.toString()}`);if(!a.ok)throw new Error("Erreur avec l'API");return await a.json()}catch(t){return console.error("Erreur lors de la r\xE9cup\xE9ration des auteurs :",t),o.innerHTML="<h1>Une erreur est survenue :/</h1>",{data:[],total:0,page:1,limit:6}}}function d(r){o.innerHTML="",r.forEach(e=>{let t=`
			<div class="author-card">
				<span id="badge-author-id">${e.id}</span>
				<h2>${e.full_name}</h2>
				<hr />
				<div class="author-details">
					<div><strong>Nationalit\xE9 :</strong></div>
					<div>${e.nationality}</div>
				</div>
				<div class="author-details">
					<div><strong>Naissance :</strong></div>
					<div>${e.birth_year}</div>
				</div>
			</div>
		`;o.innerHTML+=t})}var f=new u(l,d),c=document.getElementById("modal"),P=c?.querySelector("form");c&&P&&c.addEventListener("submit",r=>{r.preventDefault();let e=new FormData(P),t={nationality:e.getAll("nationality"),birthYear:e.getAll("birth_year")};console.log(t)});})();
